{% extends 'layout.html' %}
{% block title %}My Feedback{% endblock %}
{% block content %}
  <h2>My feedback</h2>
  {% if not feedback %}
    <p>You haven't submitted feedback yet.</p>
  {% else %}
    {% for f in feedback %}
      <div class="card">
        <div class="space-between">
          <div class="vstack">
            <strong>{{ f.title }}</strong>
            <div class="tag">Teacher: {{ f.teacher_name }} • Subject: {{ f.subject_name }}{% if f.category_name %} • Category: {{ f.category_name }}{% endif %}</div>
          </div>
          <div class="tag">{{ f.created_at }}</div>
        </div>
        <p>{{ f.info }}</p>
        {% if f.moderation_status == 'pending' %}
          <span class="badge info">Waiting for validation</span>
        {% elif f.moderation_status == 'rejected' %}
          <span class="badge danger">Rejected</span>
        {% else %}
          {% if f.is_read %}
            <span class="badge success">Read</span>
          {% else %}
            <span class="badge warn">Unread</span>
          {% endif %}
        {% endif %}
        <div class="mt-2">
          <a class="btn small" href="{{ url_for('routes.feedback_thread', feedback_id=f.id) }}">Open thread</a>
          <form method="post" action="{{ url_for('routes.delete_feedback', feedback_id=f.id) }}" class="inline" onsubmit="return confirm('Delete this feedback?');">
            <button class="btn danger small" type="submit">Delete</button>
          </form>
        </div>
      </div>
    {% endfor %}
  {% endif %}
{% endblock %}

